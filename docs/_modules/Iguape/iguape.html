
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iguape.iguape &#8212; IGUAPE - Paineira Graphical User Interface  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/Iguape/iguape';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/Logo_IGUAPE.png" class="logo__image only-light" alt="IGUAPE - Paineira Graphical User Interface  documentation - Home"/>
    <script>document.write(`<img src="../../_static/Logo_IGUAPE.png" class="logo__image only-dark" alt="IGUAPE - Paineira Graphical User Interface  documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules.html">iguape</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Iguape.html">Iguape package</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for Iguape.iguape</h1><div class="highlight"><pre>
<span></span><span class="c1">#This is part of the source code for the Paineira Graphical User Interface - Iguape</span>
<span class="c1">#The code is distributed under the GNU GPL-3.0 License. Please refer to the main page (https://github.com/cnpem/iguape) for more information</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is the main script for the excution of the Paineira Graphical User Interface, a GUI for visualization and data processing during in situ experiments at Paineira.</span>
<span class="sd">In this script, both GUIs used by the program are called and all of the backend functions and processes are defined. </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span><span class="o">,</span><span class="w"> </span><span class="nn">time</span><span class="o">,</span><span class="w"> </span><span class="nn">gc</span><span class="o">,</span><span class="w"> </span><span class="nn">copy</span><span class="o">,</span><span class="w"> </span><span class="nn">matplotlib</span><span class="o">,</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.backends.backend_qt5agg</span><span class="w"> </span><span class="kn">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.backends.backend_qt5agg</span><span class="w"> </span><span class="kn">import</span> <span class="n">NavigationToolbar2QT</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colorbar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.backends.backend_svg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.figure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.widgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpanSelector</span><span class="p">,</span> <span class="n">Cursor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScalarMappable</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.font_manager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogNorm</span><span class="p">,</span> <span class="n">PowerNorm</span><span class="p">,</span> <span class="n">CenteredNorm</span><span class="p">,</span> <span class="n">Normalize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Monitor</span><span class="w"> </span><span class="kn">import</span> <span class="n">FolderMonitor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GUI.iguape_GUI</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ui_MainWindow</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GUI.pk_window</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ui_pk_window</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GUI.export_figure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ui_Export_Figure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">GUI.filter_gui</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ui_Filter_Dialog</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Monitor</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>


<span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;frozen&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> 
    <span class="kn">import</span><span class="w"> </span><span class="nn">pyi_splash</span> <span class="c1">#If the program is executed as a pyinstaller executable, import pyi_splash for the Splash Screen</span>

<span class="n">license</span>  <span class="o">=</span> <span class="s1">&#39;GNU GPL-3.0 License&#39;</span>
    
<span class="n">counter</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fonts_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">ttflist</span><span class="p">]</span>
<span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span> <span class="k">for</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">()]</span>

<div class="viewcode-block" id="Window">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Window</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">Ui_MainWindow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for IGUAPE main window. It inherits QMainWindow from PyQt5 and Ui_MainWindow from GUI.iguape_GUI</span>

<span class="sd">    :param QMainWindow: QMainWindow from PyQt5</span>
<span class="sd">    :type QMainWindow: QMainWindow</span>
<span class="sd">    :param Ui_MainWindow: Ui_MainWindow from GUI.iguape_GUI</span>
<span class="sd">    :type Ui_MainWindow: QMainWindow</span>
<span class="sd">    &quot;&quot;&quot;</span>    
<div class="viewcode-block" id="Window.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor for Window class</span>

<span class="sd">        Args:</span>
<span class="sd">            parent (optional): Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">geometry</span> <span class="o">=</span> <span class="n">QGuiApplication</span><span class="o">.</span><span class="n">screens</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">availableGeometry</span><span class="p">()</span>
        <span class="c1">#print(geometry)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;2θ (°)&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;Intensity (a.u.)&quot;</span><span class="p">,</span> <span class="s2">&quot;Cmap_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">},</span>
                           <span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X_Label&quot;</span><span class="p">:</span>  <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;Peak Position (°)&quot;</span><span class="p">,</span> <span class="s2">&quot;Cmap_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">},</span>
                                             <span class="s2">&quot;FWHM Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X_Label&quot;</span><span class="p">:</span>  <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;FWHM (°)&quot;</span><span class="p">,</span> <span class="s2">&quot;Cmap_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">},</span>
                                             <span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X_Label&quot;</span><span class="p">:</span>  <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;Peak Integrated Area (a.u.)&quot;</span><span class="p">,</span> <span class="s2">&quot;Cmap_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">}},</span>
                           <span class="s2">&quot;Contour Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;2θ (°)&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">,</span> <span class="s2">&quot;Cmap_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;Intensity (a.u.)&quot;</span><span class="p">},</span>
                           <span class="s2">&quot;Normalization Axis&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;2θ (°)&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;Normalized Intensity (a.u.)&quot;</span><span class="p">,</span> <span class="s2">&quot;Cmap_Label&quot;</span><span class="p">:</span> <span class="s2">&quot;XRD acquisition order&quot;</span><span class="p">}}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_graphs_layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc_collector</span> <span class="o">=</span> <span class="n">GarbageCollector</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc_collector</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;frozen&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">pyi_splash</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1">#After the GUI initialization, close the Splash Screen</span></div>


<div class="viewcode-block" id="Window.create_graphs_layout">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.create_graphs_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_graphs_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Routine to initialize and connect UI elements. All parameters and flags are initiated and UI element&#39;s signals are connected to its functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">url_data</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">paineira_logo</span><span class="p">:</span> <span class="s2">&quot;https://lnls.cnpem.br/facilities/paineira-en/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LNLS_logo</span><span class="p">:</span> <span class="s2">&quot;https://lnls.cnpem.br/en/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CNPEM_logo</span><span class="p">:</span> <span class="s2">&quot;https://cnpem.br/en/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iguape_logo</span><span class="p">:</span> <span class="s2">&quot;https://cnpem.github.io/iguape/&quot;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">logo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">url_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">logo</span><span class="o">.</span><span class="n">installEventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1">#self.XRD_data_layout = QVBoxLayout()</span>
        <span class="c1"># Creating the main Figure and Layout #</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gs_main</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs_main</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;2θ (°)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity (a.u.)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Biondo Neto, J. L., Cintra Mauricio, J. &amp; Rodella, C. B. (2025). </span><span class="se">\n</span><span class="s2"> J. Appl. Cryst. 58, 1061-1067.&quot;</span><span class="p">,</span> 
                          <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XRD_data_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="p">)</span>
        <span class="c1">#self.XRD_data_tab.setLayout(self.XRD_data_layout)</span>
    
        <span class="c1">#self.peak_fit_layout = QVBoxLayout()</span>
        <span class="c1">#Creating the fitting parameter Figure and Layout#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gs_sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_sub</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_fit_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_sub</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="kc">None</span> 
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gs_contour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs_contour</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_contour</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;2θ (°)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contour_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_contour</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gs_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_norm</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;2θ (°)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalization_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_norm</span><span class="p">)</span>
        

        <span class="c1">#Creating a colormap on the main canvas#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Initial placeholder values for norm #</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="p">)</span> <span class="c1"># Creating the colorbar axes #</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cax_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">)</span> <span class="c1"># Creating the colorbar axes #</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cax_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cax_4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span><span class="p">)</span>
        <span class="c1">#Connecting functions to buttons#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_button_peak_fit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_interval</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_fit_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_fit_interval</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_peak_fit_data_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_data_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contour_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contour</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_color_pallete</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox_2</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_color_pallete</span><span class="p">)</span>
        <span class="c1">#self.checkBox.setChecked(True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_vline_checkbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_window</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_window</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_state</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norms</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LogNorm&#39;</span><span class="p">:</span> <span class="n">LogNorm</span><span class="p">(),</span> <span class="s2">&quot;PowerNorm&quot;</span><span class="p">:</span> <span class="n">PowerNorm</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="s1">&#39;CenteredNorm&#39;</span><span class="p">:</span> <span class="n">CenteredNorm</span><span class="p">(),</span> <span class="s2">&quot;LinearNorm&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_selected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask_signal</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1">#Create span selector on the main plot#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span</span> <span class="o">=</span> <span class="n">SpanSelector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onselect</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">props</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">cmaps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox_2</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">cmaps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox_2</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peak_fit_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_sub</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contour_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_contour</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalization_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_norm</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XRD_data_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;motion_notify_event&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_mouse_move</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOpen_New_Folder</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_folder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionExport_Figure</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAbout</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">about</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionQ_Vector</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_toggle_Q_vector_action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action2theta</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_toggle_2theta_action</span><span class="p">)</span>
        
        

        <span class="bp">self</span><span class="o">.</span><span class="n">offset_slider</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_slider</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>

    
        <span class="bp">self</span><span class="o">.</span><span class="n">XRD_measure_order_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measure_order_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_filter</span><span class="p">)</span></div>

    
    
<div class="viewcode-block" id="Window._open_url">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._open_url">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_open_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uses QDesktopServices to open URL from logos.</span>

<span class="sd">        :param url: url to websites (as strings)</span>
<span class="sd">        :type url: str</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span></div>

    
<div class="viewcode-block" id="Window.eventFilter">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.eventFilter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">eventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">QEvent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;eventFilter method for logo QLabel. It tracks a mouse press event and calls the :func:`Window._open_url`</span>

<span class="sd">        :param source: Object name of logo in IGUAPE UI (QLabel)</span>
<span class="sd">        :type source: QLabel</span>
<span class="sd">        :param event: QEvent to track mouse click</span>
<span class="sd">        :type event: QEvent</span>
<span class="sd">        :return: Boolean value that determines the excution of :func:`Window._open_url`</span>
<span class="sd">        :rtype: Bool</span>
<span class="sd">        &quot;&quot;&quot;</span>        
            
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonPress</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">url_data</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url_data</span><span class="p">[</span><span class="n">source</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_open_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
          
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">eventFilter</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span></div>


<div class="viewcode-block" id="Window.update_graphs">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.update_graphs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to update Main Figure (XRD Data tab) and Plotting Parameters Figure (Peak Fitting tab).</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">try</span><span class="p">:</span>
        
            <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            

            <span class="bp">self</span><span class="o">.</span><span class="n">_update_main_figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_fitting_parameters</span><span class="p">()</span>
            

            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_sub</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">cax</span><span class="o">.</span><span class="n">update_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cax_2</span><span class="o">.</span><span class="n">update_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Please, initialize the monitor! Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Please initialize the monitor!&#39;</span><span class="p">)</span> 
            <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Please, initialize the monitor! Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Please initialize the monitor!&#39;</span><span class="p">)</span> 
            <span class="k">pass</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span></div>



<div class="viewcode-block" id="Window._get_mask">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._get_mask">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for getting the :math:`2\\theta` mask, given the selection of interval by `SpanSelector` in the XRD Data tab.</span>

<span class="sd">        :param i: index of the XRD pattern</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :return: slice object as a mask.</span>
<span class="sd">        :rtype: slice</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span><span class="p">:</span>
            <span class="n">dois_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">dois_theta</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dois_theta</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="Window.update_colormap">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.update_colormap">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_colormap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_map_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine for updating the colormaps and norm used in the XRD Data and PeakFit tabs.</span>

<span class="sd">        :param color_map_type: Column label of XRD patterns DataFrame. It can be `temp` or `file_index`</span>
<span class="sd">        :type color_map_type: str</span>
<span class="sd">        :param label: _description_</span>
<span class="sd">        :type label: str</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="n">color_map_type</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="n">color_map_type</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">set_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cax</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cax_2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c1">#self.cax_3.set_label(label)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></div>


<div class="viewcode-block" id="Window._update_main_figure">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._update_main_figure">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_update_main_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine to update XRD Data Tab graph. This calls other methods such as update_colormap and plots the selected XRD measures in the main figure.  </span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_mask</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask_signal</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">IndexingError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
            <span class="n">norm_col</span> <span class="o">=</span> <span class="s1">&#39;temp&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_colormap</span><span class="p">(</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">norm_col</span> <span class="o">=</span> <span class="s1">&#39;file_index&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_colormap</span><span class="p">(</span><span class="s1">&#39;file_index&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_temp_doubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_slider</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="n">norm_col</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span> <span class="c1">#Selecting the pattern&#39;s color based on the colormap</span>
            <span class="n">dois_theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Temperature\s*\(([^)]+)\)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;XRD pattern #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> - Temperature </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;XRD pattern #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dois_theta</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">intensity</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span>
            <span class="k">del</span> <span class="n">dois_theta</span><span class="p">,</span> <span class="n">intensity</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></div>


<div class="viewcode-block" id="Window._plot_fitting_parameters">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._plot_fitting_parameters">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_fitting_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method calls :py:meth:`Window._plot_single_peak` or :py:meth:`Window._plot_double_peak`, according to the profile model selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">==</span> <span class="s1">&#39;PseudoVoigt&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_single_peak</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_double_peak</span><span class="p">()</span>

    
        <span class="n">avxspan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Selected Fitting Interval&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">avxspan</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span></div>

       
       <span class="c1"># self.canvas_sub.draw()</span>
       <span class="c1"># gc.collect()</span>

        
       <span class="c1"># self.cax_2.update_normal(self.sm)</span>
        
<div class="viewcode-block" id="Window._plot_single_peak">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._plot_single_peak">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_single_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hidden method to call :py:meth:`Window._plot_parameter` in order to plot fitting parameters of a single peak.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask_signal</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">x_data_type</span> <span class="o">=</span> <span class="s1">&#39;temp&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="k">else</span> <span class="s1">&#39;file_index&#39;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">)</span><span class="c1">#, yerr=self.monitor.fit_data[&#39;dois_theta_0_stderr&#39;].values)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">)</span><span class="c1">#, yerr=self.monitor.fit_data[&#39;area_stderr&#39;].values)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">)</span><span class="c1">#, yerr=self.monitor.fit_data[&#39;fwhm_stderr&#39;].values)</span>
        
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">)</span><span class="c1">#, yerr=self.monitor.fit_data[&#39;dois_theta_0_stderr&#39;].values)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">)</span><span class="c1">#, yerr=self.monitor.fit_data[&#39;area_stderr&#39;].values)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">)</span><span class="c1">#, yerr=self.monitor.fit_data[&#39;fwhm_stderr&#39;].values)</span></div>


        
<div class="viewcode-block" id="Window._plot_double_peak">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._plot_double_peak">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_double_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hidden method to call :py:meth:`Window._plot_parameter` in order to plot fitting parameters of a double peak.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask_signal</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">x_data_type</span> <span class="o">=</span> <span class="s1">&#39;temp&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="k">else</span> <span class="s1">&#39;file_index&#39;</span>
        <span class="n">x_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span>
        
        <span class="k">try</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_#2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_#2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_#2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
       
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_#2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_#2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="n">x_data_type</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_#2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Window._plot_parameter">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._plot_parameter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic routine to plot xy data in a given axes.</span>
<span class="sd">        Args:</span>
<span class="sd">            ax (matplotlib.axes.Axes): A matplotlib Axes object</span>
<span class="sd">            x (list): x-axis data</span>
<span class="sd">            y (list): y-axis data</span>
<span class="sd">            ylabel (str): y-axis label</span>
<span class="sd">            xlabel (str): x-axis label</span>
<span class="sd">            label (bool, optional): Displays label. Accepts True or False. Defaults to None.</span>
<span class="sd">            color (str, optional): matplotlib color. Defaults to None.</span>
<span class="sd">            marker (str, optional): matplotlib marker. Defaults to &#39;o&#39;.</span>
<span class="sd">            yerr (list, optional): y-axis error. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">norm_col</span> <span class="o">=</span> <span class="s1">&#39;temp&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="k">else</span> <span class="s1">&#39;file_index&#39;</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>
            <span class="c1">#ax.errorbar(x[i], y[i], ystderr, marker =marker, color = color, capsize=2)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
            <span class="n">peak1</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PseudoVoigt #1&#39;</span><span class="p">)</span>
            <span class="n">peak2</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PseudoVoigt #2&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak1</span><span class="p">,</span> <span class="n">peak2</span><span class="p">])</span></div>


<div class="viewcode-block" id="Window.select_folder">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.select_folder">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for selecting a folder conatining the XRD data. In order for IGUAPE to read and monitor the folder, the file iguape_filelist.txt must be present.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">folder_path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Select the data folder to monitor&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">())</span> <span class="c1"># Selection of monitoring folder</span>
        <span class="k">if</span> <span class="n">folder_path</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder_selected</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;file_index&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">,</span> <span class="s1">&#39;fwhm&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="s1">&#39;file_index&#39;</span><span class="p">,</span> <span class="s1">&#39;R-squared&#39;</span><span class="p">])</span>
            <span class="c1">#self.monitor = None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="n">counter</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_selected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask_signal</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">#folder_path = QFileDialog.getExistingDirectory(self, &#39;Select the data folder to monitor&#39;, &#39;&#39;, options=QFileDialog.Options()) # Selection of monitoring folder</span>
        <span class="k">if</span> <span class="n">folder_path</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s2">&quot;iguape_filelist.txt&quot;</span><span class="p">))):</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;This folder does not contain the iguape_filelist.txt file! Please select a valid folder!&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">folder_selected</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span> <span class="o">=</span> <span class="n">FolderMonitor</span><span class="p">(</span><span class="n">folder_path</span><span class="o">=</span><span class="n">folder_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">new_data_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_new_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No folder selected. Exiting&#39;</span><span class="p">)</span></div>

            

<div class="viewcode-block" id="Window.handle_new_data">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.handle_new_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_new_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is connected to the signal emited by :py:class:`Iguape.Monitor.FolderMonitor`, which delivers a pd.DataFrame containing the XDR data.</span>

<span class="sd">        Args:</span>
<span class="sd">            new_data (pd.DataFrame): pandas DataFrame to be concatenated with the existing one</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">new_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Window.onselect">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.onselect">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is passed as argument for the SpanSelector in the XRD Data Tab Graph.</span>
<span class="sd">        It sets the selected interval for visualization based on the min/max value received for 2theta.</span>

<span class="sd">        Args:</span>
<span class="sd">            xmin (float): minimum 2theta value of the interval selected in the XRD Data graph </span>
<span class="sd">            xmax (float): maximum 2theta value of the interval selected in the XRD Data graph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span></div>

    <span class="c1"># Reset button function #     </span>
<div class="viewcode-block" id="Window.reset_interval">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.reset_interval">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for resetting the 2theta interval in the XRD Data graph to None </span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span></div>

    <span class="c1"># Peak fit interval selection routine # </span>
<div class="viewcode-block" id="Window.select_fit_interval">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.select_fit_interval">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_fit_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for initializing the FitWindow class. This Window has the elements that control the fitting parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder_selected</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Please initialize the monitor!&#39;</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No data available. Wait for the first measure!&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_2theta</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_area</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_FWHM</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="o">=</span><span class="kc">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Reset fitting data</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval_window</span> <span class="o">=</span> <span class="n">FitWindow</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Please, push the Refresh Button! Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Please, push the Refresh Button!&#39;</span><span class="p">)</span> 
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="Window.export_figure">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.export_figure">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">export_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for initializing the ExportWindow class. This Window has the elements that control the fitting parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">tab_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_main</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_sub</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_contour</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_norm</span><span class="p">}</span>
        <span class="n">cur_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_window</span> <span class="o">=</span> <span class="n">ExportWindow</span><span class="p">(</span><span class="n">tab_dict</span><span class="p">[</span><span class="n">cur_index</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></div>


<div class="viewcode-block" id="Window.on_mouse_move">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.on_mouse_move">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_mouse_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is connected to the canvas in the XRD Data Tab graph. It shows the temperature/index of the closest XRD difractogram.</span>

<span class="sd">        Args:</span>
<span class="sd">            event (str): matplotlib FigureCanvas event.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="o">.</span><span class="n">mouse_event</span> <span class="o">=</span> <span class="n">event</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">min_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span> <span class="c1">#float(&#39;inf&#39;)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="ow">or</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Iterate over all lines in the plot, fiding the closest line point to the mouse. </span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_lines</span><span class="p">():</span>
                <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(),</span> <span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                   <span class="c1">#Find the closest point to the mouse on the line</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x_data</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_data</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x_data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="c1">#print(f&#39;Distance: {dist}&#39;, f&#39;X_curve: {x_data[idx]}&#39;, f&#39;Y_Curve: {y_data[idx]}&#39;, f&#39;X_mouse: {x}&#39;, f&#39;Y_mouse: {y}&#39;)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">min_dist</span><span class="p">:</span>
                            <span class="n">min_dist</span> <span class="o">=</span> <span class="n">dist</span> 
                            <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                        <span class="k">pass</span>
        <span class="c1">#print(f&#39;Distance: {dist}&#39;, f&#39;X_curve: {x_data[idx]}&#39;, f&#39;Y_Curve: {y_data[idx]}&#39;, f&#39;X_mouse: {x}&#39;, f&#39;Y_mouse: {y}&#39;, f&#39;Cruve label: {label}&#39;)</span>
                            
        <span class="c1">#print(label)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="sa">fr</span><span class="s1">&#39;Label: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">y</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">set_message</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;2theta=</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Intensity=</span><span class="si">{</span><span class="n">y</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">set_message</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">set_message</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Window.save_data_frame">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.save_data_frame">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_data_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method calls two hidden method that generates the DataFrame to be saved. It also writes comments (&quot;#&quot;) on the top of the csv file.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>

        <span class="c1"># Select appropriate DataFrame generator based on model and temperature</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">==</span> <span class="s1">&#39;PseudoVoigt&#39;</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_single_peak_dataframe</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_double_peak_dataframe</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save fitting Data&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;CSV (*.csv);;All Files (*)&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# For more information on each peak fit, please, refer to IGUAPE&#39;s terminal window, where you will find a complete report on each fit.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# If uncertainties were not generated for one or multiple fits, it probably beacause one or more parameters reached a boundary value. For more information refer to lmfit&#39;s documentation: https://lmfit.github.io/lmfit-py/faq.html</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data available! Please, initialize the monitor! Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Please initialize the monitor!&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1"> encountered&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Window._create_single_peak_dataframe">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._create_single_peak_dataframe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_single_peak_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for creating a DataFrame with the results of a PseudoVoigt peak fitting.</span>
<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: pandas DataFrame with fitting parameters from a PseudoVoigt single peak fit.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
            <span class="n">temp_label</span> <span class="o">=</span> <span class="s1">&#39;Cryojet Temperature (K)&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">kelvin_sginal</span> <span class="k">else</span> <span class="s1">&#39;Temperature (°C)&#39;</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="n">temp_label</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_std&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_std&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_std&#39;</span><span class="p">],</span>
            <span class="s1">&#39;R-squared (R²)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;R-squared&#39;</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Measure&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_std&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_std&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_std&#39;</span><span class="p">],</span>
            <span class="s1">&#39;R-squared (R²)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;R-squared&#39;</span><span class="p">]</span>
        <span class="p">})</span></div>


<div class="viewcode-block" id="Window._create_double_peak_dataframe">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window._create_double_peak_dataframe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_double_peak_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for creating a DataFrame with the results of a Split-PseudoVoigt peak fitting.</span>
<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: pandas DataFrame with fitting parameters from a Split-PseudoVoigt peak fit.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
            <span class="n">temp_label</span> <span class="o">=</span> <span class="s1">&#39;Cryojet Temperature (K)&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">kelvin_sginal</span> <span class="k">else</span> <span class="s1">&#39;Temperature (°C)&#39;</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="n">temp_label</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_#2&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_#2_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_#2&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_#2_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_#2&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_#2_std&#39;</span><span class="p">],</span>
            <span class="s1">&#39;R-squared (R²)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s2">&quot;R-squared&quot;</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;XRD Acquisition Number&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #1 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_#2&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;dois_theta_0_#2_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_#2&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Integrated Area Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;area_#2_std&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_#2&#39;</span><span class="p">],</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> #2 std&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s1">&#39;fwhm_#2_std&#39;</span><span class="p">],</span>
            <span class="s1">&#39;R-squared (R²)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">[</span><span class="s2">&quot;R-squared&quot;</span><span class="p">]</span>
        <span class="p">})</span></div>


<div class="viewcode-block" id="Window.validate_temp">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.validate_temp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for validating the temperature value entered in the temperature QDoubleSpinBox. It returns the closest available temperature from the Monitor&#39;s DataFrame</span>

<span class="sd">        Args:</span>
<span class="sd">            min_value (float): Minimum temperature </span>
<span class="sd">            max_value (float): Maximum temperature</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: (min_temp, max_temp) tuple with the closest min/max available temperature  </span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">min_temp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">min_value</span><span class="p">))</span>
        <span class="n">max_temp</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">max_value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">min_temp</span><span class="p">,</span> <span class="n">max_temp</span></div>

    
<div class="viewcode-block" id="Window.apply_temp_mask">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.apply_temp_mask">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_temp_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for applying a temperature mask in the XRD measures.</span>
<span class="sd">        Recieves an array of booleans. The array has a length equal to the number of XRD data read by the :py:class:`Iguape.Monitor.FolderMonitor`.</span>
<span class="sd">        Args:</span>
<span class="sd">            mask (np.array): numpy array with booleans as entries</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_mask_signal</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_main</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="Window.measure_order_index">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.measure_order_index">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">measure_order_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method connected to the measure order QCheckBox. This method will change the colormaps that identify the XRD data.</span>
<span class="sd">        All of the Figures are updated accordingly.</span>

<span class="sd">        Args:</span>
<span class="sd">            checked (bool): True or False</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_filter_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&lt;u&gt;Minimum:&lt;/u&gt;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_filter_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&lt;u&gt;Maximum:&lt;/u&gt;&#39;</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;XRD acquisition order&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_checkbox</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Window.temp_index">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.temp_index">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">temp_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method connected to the measure order QCheckBox. This method will change the colormaps that identify the XRD data.</span>
<span class="sd">        All of the Figures are updated accordingly.</span>

<span class="sd">        Args:</span>
<span class="sd">            checked (bool): True or False</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">XRD_measure_order_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">min_filter_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&lt;u&gt;Minimum Temperature:&lt;/u&gt;&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">max_filter_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&lt;u&gt;Maximum Temperature:&lt;/u&gt;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">kelvin_sginal</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Temperature (K)&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Temperature (°C)&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This experiment doesn&#39;t make use of temperature!&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">temperature_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
                    
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Please initizalie the Monitor! Error </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Please initialize the monitor!&#39;</span><span class="p">)</span>     </div>

    
<div class="viewcode-block" id="Window.read_data">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.read_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads the XRD data using pandas *read_csv* function. </span>
<span class="sd">        Comments are identified by &quot;#&quot; and the header is identified by the first line.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): </span>
<span class="sd">            normalize (bool, optional): If True the XRD intensities will be normalized. Defaults to False.</span>
<span class="sd">            Q (bool, optional): If True the XRD x-axis will be converted from 2theta to the scattering vector Q. Defaults to False.</span>
<span class="sd">        Returns:</span>
<span class="sd">            (theta, intensity): 2theta and Intensity numpy arrays read from the XRD data.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
        <span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
            <span class="n">intensity</span> <span class="o">=</span> <span class="n">normalize_array</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Q</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">calculate_q_vector</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span></div>

    
<div class="viewcode-block" id="Window.normalize">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.normalize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws an intensities normalized plot at the Normalization Plot Tab graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">spacing</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm_offset_slider</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])):</span>
                <span class="n">norm_col</span> <span class="o">=</span> <span class="s1">&#39;temp&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="k">else</span> <span class="s1">&#39;file_index&#39;</span> <span class="c1">#Flag for chosing the XRD pattern index</span>
                <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="n">norm_col</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span> <span class="c1">#Selecting the pattern&#39;s color based on the colormap</span>
                <span class="n">dois_theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dois_theta</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">intensity</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;XRD pattern #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> - Temperature </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> K&#39;</span>                                                                                                                  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;XRD pattern #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">offset</span> <span class="o">+=</span> <span class="n">spacing</span>
                <span class="k">del</span> <span class="n">dois_theta</span><span class="p">,</span> <span class="n">intensity</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_colormap</span><span class="p">(</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_colormap</span><span class="p">(</span><span class="s1">&#39;file_index&#39;</span><span class="p">,</span> <span class="s1">&#39;XRD acquisition time&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">cax_4</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_norm</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_norm</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="ow">or</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Please, select a folder!&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Window.contour">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.contour">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contour</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws a contour plot at the Contour Plot Tab graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">]:</span>
                <span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">mask</span><span class="p">])</span> 
                <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>

            <span class="c1">#print(f&#39;Shape X and Y: {np.shape(X)}, {np.shape(Y)}. Z shape: {np.shape(z)}&#39;)</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">norm_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()]</span>
            <span class="n">colormesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cax_3</span><span class="o">.</span><span class="n">update_normal</span><span class="p">(</span><span class="n">colormesh</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cax_3</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Cmap_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_contour</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="n">colormesh</span><span class="o">.</span><span class="n">set_rasterized</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas_contour</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">del</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">z</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="ow">or</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Please, select a folder!&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Window.on_change_color_pallete">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.on_change_color_pallete">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_color_pallete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the current item in the QComboBox.</span>

<span class="sd">        Args:</span>
<span class="sd">            index (int): Integer representing the index of item in the Color pallete QComboBox.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete_comboBox_2</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span></div>


<div class="viewcode-block" id="Window.apply_filter">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.apply_filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the :py:class:`FilterWindow` class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">:</span>
            <span class="k">return</span>       
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filter_window</span> <span class="o">=</span> <span class="n">FilterWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">data_frame</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">kelvin_sginal</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filter_window</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_temp_mask</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filter_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="ow">or</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;No folder was selected&quot;</span><span class="p">,</span> <span class="s2">&quot;Select a folder to monitor!&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Window.on_toggle_Q_vector_action">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.on_toggle_Q_vector_action">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_toggle_Q_vector_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is triggred when the Q vector visualization option is selected by the user.</span>
<span class="sd">        This renders a QDialog for user input of the wavelength and than updates the graphs to plot as function of Q.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QInputDialog</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setInputMode</span><span class="p">(</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">DoubleInput</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setLocale</span><span class="p">(</span><span class="n">QLocale</span><span class="p">(</span><span class="n">QLocale</span><span class="o">.</span><span class="n">English</span><span class="p">,</span> <span class="n">QLocale</span><span class="o">.</span><span class="n">UnitedStates</span><span class="p">))</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setLabelText</span><span class="p">(</span><span class="s2">&quot;Input Wavelength of XRD experiment (Å)&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setDoubleMinimum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setDoubleMaximum</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setDoubleStep</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setDoubleDecimals</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setDoubleValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Wavelenght&quot;</span><span class="p">)</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ok</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">doubleValue</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actionQ_Vector</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Invlid Wavelenght&quot;</span><span class="p">,</span> <span class="s2">&quot;Please insert a valid wavelength for Q vector computation&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">action2theta</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">doubleValue</span><span class="p">()</span>    
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Q ($Å^{-1}$)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Q ($Å^{-1}$)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Q ($Å^{-1}$)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Peak position ($Å^{-1}$)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\delta$Q ($Å^{-1}$)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_interval</span> <span class="o">=</span> <span class="kc">None</span></div>

        <span class="c1">#self.update_graphs()</span>

<div class="viewcode-block" id="Window.on_toggle_2theta_action">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.on_toggle_2theta_action">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_toggle_2theta_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is triggred when the 2theta visualization option is selected by the user.</span>
<span class="sd">        This is the default visualization mode. The method updates the graphs to plot as function of 2theta.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">actionQ_Vector</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action2theta</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2θ (°)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Normalization Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2θ (°)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Contour Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2θ (°)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Peak Position Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Peak position (°)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Peak Fit Axis&quot;</span><span class="p">][</span><span class="s2">&quot;FWHM Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FWHM (°)&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q_vector_state</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Window.on_change_vline_checkbox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.on_change_vline_checkbox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_vline_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method enables a Vertical Line cursor in the XRD Data Tab Figure. </span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="n">Cursor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_main</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizOn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor</span> <span class="o">=</span> <span class="kc">None</span></div>

    
<div class="viewcode-block" id="Window.about">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Window.about">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">about</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a QMessageBox with some info on IGUAPE.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;About Iguape&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&lt;p&gt;This is the Paineira Graphical User Interface&lt;/p&gt;&quot;</span>
            <span class="s2">&quot;&lt;p&gt;- Its usage is resttricted to data acquired via in-situ experiments at Paineira. The software is under the GNU GPL-3.0 License.&lt;/p&gt;&quot;</span>
            <span class="s2">&quot;&lt;p&gt;- For more information, please refer to the &lt;a href=&#39;https://github.com/cnpem/iguape&#39;&gt;GitHub&lt;/a&gt; page or &lt;a href=&#39;https://cnpem.github.io/iguape/&#39;&gt;IGUAPE&lt;/a&gt; documentation page&lt;/p&gt;&quot;</span>
            <span class="s2">&quot;&lt;p&gt;- Paineira Beamline&lt;/p&gt;&quot;</span>
            <span class="s2">&quot;&lt;p&gt;- LNLS - CNPEM&lt;/p&gt;&quot;</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>


<div class="viewcode-block" id="GarbageCollector">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.GarbageCollector">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GarbageCollector</span><span class="p">(</span><span class="n">QThread</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Garbage Collector class. Inherits a QThread and calls, every 3 seconds, the collect method of python&#39;s garbage collector.</span>
<span class="sd">    The matpltolib Figures are updated using **for loops**. This consumes a lot of RAM memory. This method frees up some memory space.</span>

<span class="sd">    Args:</span>
<span class="sd">        QThread (QThread): QThread class from PyQt5</span>
<span class="sd">    &quot;&quot;&quot;</span>    
<div class="viewcode-block" id="GarbageCollector.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.GarbageCollector.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="GarbageCollector.run">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.GarbageCollector.run">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calls the collect method from python&#39;s Garbage Collector every 3 seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="Worker">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Worker">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Worker</span><span class="p">(</span><span class="n">QThread</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;QThread that performs peak fitting in the selected XRD data.</span>
<span class="sd">    Args:</span>
<span class="sd">        QThread (QThread): QThread class from PyQt5</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">progress</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">finished</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> 
    <span class="n">error</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1"># Changed to emit multiple arrays</span>

<div class="viewcode-block" id="Worker.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Worker.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Constructor for the peak fitting thread.</span>

<span class="sd">        Args:</span>
<span class="sd">            interval (list): List in the form [:math:`2\theta_{i}`, :math:`2\theta_{f}`] where :math:`2\theta_{i}` and :math:`2\theta_{f}` are, respectively,</span>
<span class="sd">            the initial and final values of the 2theta interval selected to perfor peak fitting.</span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span> <span class="o">=</span> <span class="n">interval</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span></div>


<div class="viewcode-block" id="Worker.run">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.Worker.run">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Performs peak fitting in the selected XRD data in the selected 2theta interval [:math:`2\theta_{i}`, :math:`2\theta_{f}`]</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">pars</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])):</span>
                <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">win</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">==</span> <span class="s1">&#39;PseudoVoigt&#39;</span><span class="p">:</span>
                    <span class="n">fit</span> <span class="o">=</span> <span class="n">peak_fit</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">pars</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dois_theta_std</span><span class="p">,</span> <span class="n">fwhm_std</span><span class="p">,</span> <span class="n">area_std</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;fwhm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Excepetion </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">dois_theta_std</span><span class="p">,</span> <span class="n">fwhm_std</span><span class="p">,</span> <span class="n">area_std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
                    <span class="n">new_fit_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;dois_theta_0_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dois_theta_std</span><span class="p">],</span> <span class="s1">&#39;fwhm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;fwhm_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fwhm_std</span><span class="p">],</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;area_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">area_std</span><span class="p">],</span> <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;file_index&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;R-squared&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">3</span><span class="p">]]})</span>
                    <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">,</span> <span class="n">new_fit_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pars</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
                    <span class="n">progress_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">progress_value</span><span class="p">)</span>  <span class="c1"># Emit progress signal with percentage</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fit</span> <span class="o">=</span> <span class="n">peak_fit_split_gaussian</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">distance</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">prominence</span><span class="p">,</span> <span class="n">pars</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dois_theta_std</span><span class="p">,</span> <span class="n">fwhm_std</span><span class="p">,</span> <span class="n">area_std</span><span class="p">,</span> <span class="n">dois_theta_2_std</span><span class="p">,</span> <span class="n">fwhm_2_std</span><span class="p">,</span> <span class="n">area_2_std</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;cen1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;sigma1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;amp1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;cen2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;sigma2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="s1">&#39;amp2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stderr</span><span class="o">*</span><span class="mi">1</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">dois_theta_std</span><span class="p">,</span> <span class="n">fwhm_std</span><span class="p">,</span> <span class="n">area_std</span><span class="p">,</span> <span class="n">dois_theta_2_std</span><span class="p">,</span> <span class="n">fwhm_2_std</span><span class="p">,</span> <span class="n">area_2_std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
                    <span class="n">new_fit_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;dois_theta_0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;dois_theta_0_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dois_theta_std</span><span class="p">],</span> <span class="s1">&#39;dois_theta_0_#2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;dois_theta_0_#2_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dois_theta_2_std</span><span class="p">],</span><span class="s1">&#39;fwhm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;fwhm_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fwhm_std</span><span class="p">],</span> <span class="s1">&#39;fwhm_#2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;fwhm_#2_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fwhm_2_std</span><span class="p">],</span><span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;area_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">area_std</span><span class="p">],</span><span class="s1">&#39;area_#2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;area_#2_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">area_2_std</span><span class="p">],</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;file_index&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;R-squared&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fit</span><span class="p">[</span><span class="mi">3</span><span class="p">]]})</span>
                    <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">fit_data</span><span class="p">,</span> <span class="n">new_fit_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pars</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
                    <span class="n">progress_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">progress_value</span><span class="p">)</span>  <span class="c1"># Emit progress signal with percentage</span>
            <span class="c1">#self.finished.emit(win.monitor.fit_data[&#39;dois_theta_0&#39;], win.monitor.fit_data[&#39;area&#39;], win.monitor.fit_data[&#39;fwhm&#39;])  # Emit finished signal with results</span>
            <span class="n">finish</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">finish</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error during peak fitting: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s1">. Please select a new Fit Interval&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exception </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">. Please select a new Fit Interval&#39;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="FilterWindow">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FilterWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">Ui_Filter_Dialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        QDialog (QDialog): QDialog class from PyQt5</span>
<span class="sd">        Ui_Filter_Dialog (QDialog): Custom QDialog class made from QtDesigner</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">mask</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<div class="viewcode-block" id="FilterWindow.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kelvin_signal</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>
<span class="sd">        This method will initialize the QDialog and render a QListView() in the QDialog Window.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.DataFrame, optional): *pandas DataFrame* containing the names of the XRD data files. Defaults to None.</span>
<span class="sd">            kelvin_signal (Bool, optional): Defines if the temperature unit is K or °C. Defaults to None.</span>
<span class="sd">            parent (_type_, optional): _description_. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">kelvin_signal</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;°C&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_df</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="n">QListView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">CustomListViewModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QListView</span><span class="o">.</span><span class="n">ExtendedSelection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_all_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_state_checked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_state_unchecked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle_selected_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_state_selected</span><span class="p">)</span></div>

        
        
        
<div class="viewcode-block" id="FilterWindow.setup_df">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow.setup_df">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setup_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the data as unchecked</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">checked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;checked&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checked</span>
        <span class="k">return</span></div>

    
<div class="viewcode-block" id="FilterWindow.set_state_checked">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow.set_state_checked">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_state_checked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the state of a given item as checked</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">CheckStateRole</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="FilterWindow.set_state_unchecked">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow.set_state_unchecked">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_state_unchecked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the state of a given item as unchecked</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">CheckStateRole</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="FilterWindow.set_state_selected">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow.set_state_selected">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_state_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the state of a given item as selected</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">CheckStateRole</span><span class="p">)</span></div>



<div class="viewcode-block" id="FilterWindow.apply">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FilterWindow.apply">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send the maks to IGUAPE&#39;s main Window</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">win</span><span class="p">,</span> <span class="s2">&quot;No data was selected&quot;</span><span class="p">,</span> <span class="s2">&quot;Please, select at least one XRD diffractogram!&quot;</span><span class="p">)</span>
            <span class="k">return</span></div>
</div>



<div class="viewcode-block" id="CustomListViewModel">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.CustomListViewModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CustomListViewModel</span><span class="p">(</span><span class="n">QAbstractListModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom QListView made to display the data correctly.</span>

<span class="sd">    Args:</span>
<span class="sd">        QAbstractListModel (QAbstractListModel): QAbstractListModel from PyQt5</span>
<span class="sd">    &quot;&quot;&quot;</span>    
<div class="viewcode-block" id="CustomListViewModel.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.CustomListViewModel.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.DataFrame, optional): *pandas DataFrame* containing the names of the XRD data files. Defaults to None.. Defaults to None.</span>
<span class="sd">            unit (str, optional): Temperature unit. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span></div>


<div class="viewcode-block" id="CustomListViewModel.rowCount">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.CustomListViewModel.rowCount">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rowCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">QModelIndex</span><span class="p">()):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the length of the *pandas DataFrame*, i.e. the number of columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            parent (_type_, optional): _description_. Defaults to QModelIndex().</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span></div>


<div class="viewcode-block" id="CustomListViewModel.data">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.CustomListViewModel.data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            index (QModelIndex): PyQt5 index for each item</span>
<span class="sd">            role (Qt.DisplayRolde, optional): PyQt5 Display Role for each item</span>

<span class="sd">        Returns:</span>
<span class="sd">            QVariant:</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">QVariant</span><span class="p">()</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;file_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2"> |XRD Acquisition # </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;file_index&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">entry</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">CheckStateRole</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;checked&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span>
        <span class="k">return</span> <span class="n">QVariant</span><span class="p">()</span></div>


<div class="viewcode-block" id="CustomListViewModel.setData">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.CustomListViewModel.setData">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">EditRole</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the status of an item</span>

<span class="sd">        Args:</span>
<span class="sd">            index (QIndexModel): PyQt5 index for each item</span>
<span class="sd">            value (Qt.CheckState): PyQt5 CheckState of the item</span>
<span class="sd">            role (Qt.EditRole, optional): Defaults to Qt.EditRole.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Bool: </span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">CheckStateRole</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="s1">&#39;checked&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="CustomListViewModel.flags">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.CustomListViewModel.flags">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Defines the properties of each item</span>

<span class="sd">        Args:</span>
<span class="sd">            index (QIndexModel): PyQt5 index for each item</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsSelectable</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsUserCheckable</span></div>
</div>




<div class="viewcode-block" id="ExportWindow">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ExportWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">Ui_Export_Figure</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom QDialog for managing Figure export.</span>

<span class="sd">    Args:</span>
<span class="sd">        QDialog (QDialog): QDialog class from PyQt5</span>
<span class="sd">        Ui_Export_Figure (_type_): Custom QDialog mode with QDesigner</span>
<span class="sd">    &quot;&quot;&quot;</span>    
<div class="viewcode-block" id="ExportWindow.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">:</span> <span class="n">Figure</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>

<span class="sd">        Args:</span>
<span class="sd">            figure (matplotlib.figure.Figure): *matplotlib* Figure class</span>
<span class="sd">            parent (_type_, optional): Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
        <span class="c1">#geometry = QGuiApplication.screens()[-1].availableGeometry()</span>
        <span class="c1">#self.setGeometry(geometry)</span>
        <span class="c1">#self.setBaseSize(self.w, self.h)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1">#self.xlabel_lineEdit.setEnabled(False)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ylabel_lineEdit</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1">#self.cmap_label_lineEdit.setEnabled(False)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel_lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel_lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmap_ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">cmap_label_lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap_ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi_spinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">dpi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">fonts_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redraw_fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_comboBox</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_font_comboBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_size_spinBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_label_size_spinBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_style_comboBox</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_label_style_comboBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_size_spinBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_tick_size_spinBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_style_comboBox</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_change_tick_style_comboBox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_fig_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span>
                     <span class="s1">&#39;color&#39;</span><span class="p">:</span>  <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_size_spinBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                     <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span>
                     <span class="s1">&#39;color&#39;</span><span class="p">:</span>  <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_size_spinBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                     <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                    <span class="p">}</span></div>

<div class="viewcode-block" id="ExportWindow.get_color">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.get_color">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the color selected with QColorDialog and sets the button color to it.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">color</span> <span class="o">=</span> <span class="n">QColorDialog</span><span class="p">()</span><span class="o">.</span><span class="n">getColor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">color</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_pallete</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: </span><span class="si">%s</span><span class="s2">;&quot;</span> <span class="o">%</span> <span class="n">color</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
        <span class="k">return</span></div>

    
    
<div class="viewcode-block" id="ExportWindow.on_change_font_comboBox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.on_change_font_comboBox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_font_comboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the label and tick font.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            font (str): Font for label and ticks</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
        <span class="k">return</span></div>

    
<div class="viewcode-block" id="ExportWindow.on_change_label_size_spinBox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.on_change_label_size_spinBox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_label_size_spinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the label font size</span>

<span class="sd">        Args:</span>
<span class="sd">            value (int): Font size</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="ExportWindow.on_change_tick_size_spinBox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.on_change_tick_size_spinBox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_tick_size_spinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the tick font size</span>

<span class="sd">        Args:</span>
<span class="sd">            value (int): Font size</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="ExportWindow.on_change_label_style_comboBox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.on_change_label_style_comboBox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_label_style_comboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the label style</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            style (str): Label style (italic/bold/normal)</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;bold&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="ExportWindow.on_change_tick_style_comboBox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.on_change_tick_style_comboBox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_change_tick_style_comboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the tick style</span>

<span class="sd">        Args:</span>
<span class="sd">            style (str): Tick style (italic/bold/normal)</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;bold&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span>
        <span class="k">return</span></div>

    

<div class="viewcode-block" id="ExportWindow.redraw_fig">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.redraw_fig">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">redraw_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Redraws the Figure according to the changes made by the user.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_doubleSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_doubleSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">tickfont</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">],</span>
                                                          <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">],</span>
                                                          <span class="n">weight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span>
                                                          <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tick_font</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlabel_lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">fontdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">(),</span> <span class="n">fontdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                    <span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">tickfont</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlabel_lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">fontdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylabel_lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">fontdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                    <span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">tickfont</span><span class="p">)</span>
        
            

        <span class="bp">self</span><span class="o">.</span><span class="n">cmap_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap_label_lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">fontdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmap_ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
            <span class="n">label</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">tickfont</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="c1">#self.canvas.resize(int(width*self.edit_fig.dpi), int(height*self.edit_fig.dpi))</span>
        <span class="c1">#self.setGeometry(0, 0, int(width*self.edit_fig.dpi), int(height*self.edit_fig.dpi))</span>
        
        

        
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="k">return</span></div>

    
<div class="viewcode-block" id="ExportWindow.save_fig">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.ExportWindow.save_fig">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the Figure according to the chosen format.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select Save Path&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="n">options</span><span class="o">=</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Saving Error&#39;</span><span class="p">,</span> <span class="s2">&quot;Please, select a valid path for your Figure&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="c1">#self.canvas.resize(int(width*self.edit_fig.dpi), int(height*self.edit_fig.dpi))</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># try-except to handle save when height and width are None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi_spinBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                         <span class="nb">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span>
                         <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">)</span></div>
</div>

        


            

<div class="viewcode-block" id="FitWindow">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FitWindow</span><span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">Ui_pk_window</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;QDialog Window to manage the Peak Fitting options.</span>

<span class="sd">    Args:</span>
<span class="sd">        QDialog (QDialog): QDialog from PyQt5</span>
<span class="sd">        Ui_pk_window (QDialog): Custom QDialog made with QDesigner</span>
<span class="sd">    &quot;&quot;&quot;</span>    
<div class="viewcode-block" id="FitWindow.__init__">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>

<span class="sd">        Args:</span>
<span class="sd">            parent (optional): Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">=</span> <span class="s1">&#39;PseudoVoigt&#39;</span>
        <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">set_fit_model</span> <span class="o">=</span> <span class="s2">&quot;PseudoVoigt&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mf">1e+09</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prominence</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_layout</span><span class="p">()</span></div>


<div class="viewcode-block" id="FitWindow.setup_layout">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.setup_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setup_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the figures layout and connects the widgets to its functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Peak Fit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pk_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
            <span class="c1">#theta, intensity = win.read_data(win.plot_data[&#39;file_name&#39;][0])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;XRD pattern &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;°C&#39;</span><span class="p">)</span>
            <span class="c1">#self.ax.plot(win.plot_data[&#39;theta&#39;][0], win.plot_data[&#39;intensity&#39;][0],&#39;o&#39;, markersize=3, label = &#39;XRD pattern &#39; + str(win.plot_data[&#39;temp&#39;][0]) + &#39;°C&#39;)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;XRD pattern #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="c1">#self.ax.plot(win.plot_data[&#39;theta&#39;][0], win.plot_data[&#39;intensity&#39;][0], &#39;o&#39;, markersize=3, label = &#39;XRD pattern #&#39; + str(win.plot_data[&#39;file_index&#39;][0]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;X_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">props_dict</span><span class="p">[</span><span class="s2">&quot;Main Axis&quot;</span><span class="p">][</span><span class="s2">&quot;Y_Label&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pk_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pk_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pk_frame</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pk_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span</span> <span class="o">=</span> <span class="n">SpanSelector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onselect</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">useblit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">props</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_plot_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pk_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shade</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="k">if</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
            <span class="n">items_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;°C&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xrd_combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">items_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">items_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xrd_combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">items_list</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xrd_combo_box</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onChanged_xrd_combo_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pk_combo_box</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onChanged_pk_combo_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bgk_combo_box</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onChanged_bkg_combo_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preview_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_spinBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onChanged_distance_spinbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height_spinBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onChanged_height_spinbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prominence_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prominence_spinBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onChanged_prominence_spinbox</span><span class="p">)</span></div>


<div class="viewcode-block" id="FitWindow.onChanged_xrd_combo_box">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onChanged_xrd_combo_box">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onChanged_xrd_combo_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a new XRD difractogram to the Figure. If there&#39;s already two plotted, it will ask to user to clear the canvas.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text from the QComboBox. It identifies the XRD data.</span>
<span class="sd">        &quot;&quot;&quot;</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Warning! It is possible to display only two XRD patterns in this window! Please press the Clear Plot button and select up to 2 XRD patterns to be displayed.&#39;</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrd_combo_box</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;XRD pattern &#39;</span> <span class="o">+</span> <span class="n">text</span><span class="p">))</span>

                <span class="c1">#self.ax.plot(win.plot_data[&#39;theta&#39;][i], win.plot_data[&#39;intensity&#39;][i], &#39;o&#39;, markersize=3, label = (&#39;XRD pattern &#39; + text))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;XRD pattern #&#39;</span> <span class="o">+</span> <span class="n">text</span><span class="p">))</span>
                <span class="c1">#self.ax.plot(win.plot_data[&#39;theta&#39;][i], win.plot_data[&#39;intensity&#39;][i], &#39;o&#39;, markersize=3, label = (&#39;XRD pattern #&#39; + text))</span>
        
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;2θ (°)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity (u.a.)&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="FitWindow.onChanged_pk_combo_box">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onChanged_pk_combo_box">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onChanged_pk_combo_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Routine for selecting the Peak Fitting Model via the ComboBox.</span>
<span class="sd">        </span>
<span class="sd">        Parameters </span>
<span class="sd">        ----------</span>
<span class="sd">            text (str): Text selected on the ComboBox</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;PseudoVoigt Model&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">=</span> <span class="s1">&#39;PseudoVoigt&#39;</span>
            <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">set_fit_model</span> <span class="o">=</span> <span class="s1">&#39;PseudoVoigt&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prominence_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;Split PseudoVoigt Model - 2x PseudoVoigt&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">=</span> <span class="s1">&#39;2x PseudoVoigt(SPV)&#39;</span>
            <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">set_fit_model</span> <span class="o">=</span> <span class="s1">&#39;2x PseudoVoigt(SPV)&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prominence_spinBox</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="FitWindow.onChanged_bkg_combo_box">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onChanged_bkg_combo_box">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onChanged_bkg_combo_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the Background model. Currently only Linear model is applied.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (_type_): _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>        

        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;Linear Model&#39;</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">bkg_model</span> <span class="o">=</span> <span class="s1">&#39;Linear&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bkg_model</span> <span class="o">=</span> <span class="s1">&#39;Spline&#39;</span></div>


<div class="viewcode-block" id="FitWindow.onselect">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onselect">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the selected fit interval as [xmin, xmax]. It also draws a rectangle spaning the interval (axvspan)</span>

<span class="sd">        Args:</span>
<span class="sd">            xmin (float): Lower bound of the interval</span>
<span class="sd">            xmax (flat): Upper bound of the interval</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shade</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shade</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interval_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">xmin</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">xmax</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shade</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Selected Fitting Interval&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="FitWindow.onChanged_distance_spinbox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onChanged_distance_spinbox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onChanged_distance_spinbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the distance to value. Only valid for Spli PseudoVoigt model</span>

<span class="sd">        Args:</span>
<span class="sd">            value (int): Minimum distance (in experimental points) between peaks.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">value</span></div>


<div class="viewcode-block" id="FitWindow.onChanged_height_spinbox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onChanged_height_spinbox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onChanged_height_spinbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the height to value (x1e09). Only valid for Spli PseudoVoigt model</span>

<span class="sd">        Args:</span>
<span class="sd">            value (float): Minimum height of peaks. This float is multiplied by 1e09.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="p">(</span><span class="mf">1e+09</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="FitWindow.onChanged_prominence_spinbox">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.onChanged_prominence_spinbox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onChanged_prominence_spinbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the prominence to value. Only valid for Spli PseudoVoigt model</span>

<span class="sd">        Args:</span>
<span class="sd">            value (int): Prominence of peaks. Prominence is the difference between the maximum value of the peak and the background of the measure.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">prominence</span> <span class="o">=</span> <span class="n">value</span></div>


<div class="viewcode-block" id="FitWindow.clear_plot">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.clear_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clears the Figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


<div class="viewcode-block" id="FitWindow.preview">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.preview">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">preview</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a preview of the Peak Fit in the Figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>  
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span> <span class="o">==</span> <span class="s2">&quot;PseudoVoigt&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">)):</span>
                <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">Q</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">peak_fit</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
                <span class="n">best_fit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">best_fit</span>
                <span class="c1">#dely = data[4].eval_uncertainty(sigma = 3)</span>
                <span class="k">if</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Best Fit - </span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1"> °C&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;bkg_&#39;</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Background - </span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1"> °C&#39;</span><span class="p">)</span>
                    <span class="c1">#self.ax.fill_between(data[6],best_fit-dely, best_fit+dely, color=&#39;darkslategrey&#39;, alpha=0.9, label=r&quot;3-$\sigma$ uncertainty band&quot;)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Best Fit - #</span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;bkg_&#39;</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Background - #</span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="c1">#self.ax.fill_between(data[6],best_fit-dely, best_fit+dely, color = &quot;darkslategrey&quot;, alpha=0.9, label=r&quot;3-$\sigma$ uncertainty band&quot;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">Q</span><span class="o">=</span><span class="n">win</span><span class="o">.</span><span class="n">Q_vector_state</span><span class="p">)</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="p">[</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;file_index&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">peak_fit_split_gaussian</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prominence</span><span class="p">)</span>
                    <span class="n">best_fit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">best_fit</span>
                    <span class="c1">#dely = data[4].eval_uncertainty(sigma = 3)</span>
                    <span class="k">if</span> <span class="n">win</span><span class="o">.</span><span class="n">plot_with_temp</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Best Fit - </span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1"> °C&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;bkg_&#39;</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Background - </span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1"> °C&#39;</span><span class="p">)</span>
                        <span class="c1">#self.ax.fill_between(data[6],best_fit-dely, best_fit+dely, color=&#39;darkslategrey&#39;, alpha=0.9, label=r&quot;3-$\sigma$ uncertainty band&quot;)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Best Fit - #</span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;bkg_&#39;</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Background - #</span><span class="si">{</span><span class="n">win</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="s2">&quot;file_index&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="c1">#self.ax.fill_between(data[6],best_fit-dely, best_fit+dely, color=&#39;darkslategrey&#39;, alpha=0.9, label=r&quot;3-$\sigma$ uncertainty band&quot;)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">UnboundLocalError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;The value given for distance and/or height for peak search are out of bounds, i.e., it was not possible to find two peaks mtaching the given parameters! Please, try again with different values for distance and height!&#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;One or more peak parameters have reached a boundary value! Please check IGUAPE terimnal window for a fit report!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="FitWindow.fit">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.fit">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the fit, with the model, interval and data selected in the XRD Data Tab.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">set_fit_interval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">)</span>
        <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">set_distance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
        <span class="n">win</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">win</span><span class="o">.</span><span class="n">fit_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span>
        <span class="n">win</span><span class="o">.</span><span class="n">fit_interval_window</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span> <span class="o">=</span> <span class="n">QProgressDialog</span><span class="p">(</span><span class="s2">&quot;Fitting peaks...&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">setWindowModality</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowModal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">setAutoClose</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">setCancelButton</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Start the worker thread for peak fitting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_interval</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_progress</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_fitting_finished</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_fitting_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>


<div class="viewcode-block" id="FitWindow.update_progress">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.update_progress">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the QProgressDialog with a percentage progress</span>

<span class="sd">        Args:</span>
<span class="sd">            value (int): Progress percentage</span>
<span class="sd">        &quot;&quot;&quot;</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="FitWindow.peak_fitting_finished">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.peak_fitting_finished">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">peak_fitting_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shows QMessageBox when Peak Fitting is done.</span>

<span class="sd">        Args:</span>
<span class="sd">            time (float): Time spent during Peak Fit </span>
<span class="sd">        &quot;&quot;&quot;</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Peak Fitting&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Peak fitting completed successfully! For more information on each fit, check the terminal for the fit report! Elapsed time: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
        <span class="n">win</span><span class="o">.</span><span class="n">update_graphs</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="FitWindow.peak_fitting_error">
<a class="viewcode-back" href="../../Iguape.html#Iguape.iguape.FitWindow.peak_fitting_error">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">peak_fitting_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error_message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shows QMessageBox if there&#39;s been an error during peak fitting.</span>

<span class="sd">        Args:</span>
<span class="sd">            error_message (str): Error message</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_dialog</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Peak Fitting Error&quot;</span><span class="p">,</span> <span class="n">error_message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>


        

        


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">win</span> <span class="o">=</span> <span class="n">Window</span><span class="p">()</span>
    <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec</span><span class="p">())</span>
</pre></div>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By João Luis Biondo Neto; Junior Cintra Mauricio; Cristiane Barbieri Rodella
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>